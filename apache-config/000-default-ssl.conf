<VirtualHost *:443>
    ServerName mkassurance.fr
    ServerAlias www.mkassurance.fr

    DocumentRoot /var/www/html

    SSLEngine on
    SSLCertificateFile /var/www/ssl/fullchain.pem
    SSLCertificateKeyFile /var/www/ssl/privkey.pem

    <Directory /var/www/html>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    <FilesMatch "\.(css)$">
        SetEnvIf Request_URI "\.(css)$" no-gzip
        Header set Content-Type "text/css; charset=utf-8"
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>

    <FilesMatch "\.(js)$">
        Header set Content-Type "application/javascript; charset=utf-8"
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>

    <FilesMatch "\.(mp4|webm|ogg|avi|mov)$">
        Header set Content-Type "video/mp4"
        Header set Accept-Ranges "bytes"
        Header set Cache-Control "max-age=3600, public"
        SetEnvIf Range "bytes=.*" RANGE_REQUEST
        Header set "Accept-Ranges" "bytes" env=RANGE_REQUEST
    </FilesMatch>

    <FilesMatch "\.(png|jpg|jpeg|gif|ico|svg)$">
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteCond %{REQUEST_URI} !\.(css|js|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot|mp4|webm|ogg|avi|mov)$ [NC]
        RewriteRule ^(.*)$ index.php/$1 [QSA,L]
    </IfModule>
</VirtualHost>